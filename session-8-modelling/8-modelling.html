<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Modelling</title>

<script src="6-modelling_files/header-attrs-2.9/header-attrs.js"></script>
<script src="6-modelling_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="6-modelling_files/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="6-modelling_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="6-modelling_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="6-modelling_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="6-modelling_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="6-modelling_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="6-modelling_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="6-modelling_files/navigation-1.1/tabsets.js"></script>
<link href="6-modelling_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="6-modelling_files/pagedtable-1.1/js/pagedtable.js"></script>
<script src="6-modelling_files/kePrint-0.0.1/kePrint.js"></script>
<link href="6-modelling_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Modelling</h1>
<h3 class="subtitle">Reporting, summarising and communicating models in R</h3>

</div>


<hr />
<p>Welcome back! I hope you all enjoyed the course-free Midterm Week! üèñ</p>
<p>Last session we talked a bit about how you might scrape innovative data from the web. Collecting data is not an end in itself, rather you do it to be able to run models that explore, infer or predict outcomes. We won‚Äôt focus on the statistical considerations that inform your model choice, instead we will show you how to:</p>
<ul>
<li>use formulas to specify multiple models</li>
<li>process (estimate) model results with <code>broom</code></li>
<li>summarise outputs with <code>modelsummary</code></li>
<li>communicate results through plots and tables</li>
</ul>
<hr />
<div id="the-model-workflow-with-r" class="section level1">
<h1>The Model Workflow with R</h1>
<p>While the last session dealt with one of the sexier areas of Data Science (Web Scraping), today we will go back to the <strong>bread and butter</strong> üçû of any self-respecting data scientist - modelling!</p>
<p>But if we are not even talking about ML, DL or model choice, why bother? Well, as with most things it is worth to revisit fundamentals from time to time. By investing just a little more effort here, we can create <em>much better</em> reports and papers!</p>
<p>In general, remember, your basic <strong>workflow for evaluating and reporting models</strong> is the following:</p>
<p><img src="pics/data-science-communicate.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Today we will mostly deal with the model and communicate steps in the graph.</p>
<hr />
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Before we get started with the actual coding we need to load a few packages and get some data. We are using <a href="https://www.kaggle.com/kumarajarshi/life-expectancy-who">this WHO dataset</a> on life expectancy.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(kableExtra, tidyverse, broom, modelsummary, specr, janitor, modelr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>life_expec_dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;life_expectancy.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">developed =</span> <span class="fu">if_else</span>(status <span class="sc">==</span> <span class="st">&quot;Developed&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">large =</span> <span class="fu">if_else</span>(population <span class="sc">&gt;</span> <span class="dv">50000000</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(life_expec_dat)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["status"],"name":[3],"type":["chr"],"align":["left"]},{"label":["life_expectancy"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["adult_mortality"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["infant_deaths"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["percentage_expenditure"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["hepatitis_b"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["measles"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["under_five_deaths"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["polio"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["total_expenditure"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["diphtheria"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["hiv_aids"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["gdp"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["population"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["thinness_1_19_years"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["thinness_5_9_years"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["income_composition_of_resources"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["schooling"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["developed"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["large"],"name":[24],"type":["dbl"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"2015","3":"Developing","4":"65","5":"263","6":"62","7":"0.01","8":"71.3","9":"65","10":"1154","11":"19","12":"83","13":"6","14":"8.2","15":"65","16":"0.1","17":"584","18":"3.4e+07","19":"17","20":"17","21":"0.48","22":"10.1","23":"0","24":"0"},{"1":"Afghanistan","2":"2014","3":"Developing","4":"60","5":"271","6":"64","7":"0.01","8":"73.5","9":"62","10":"492","11":"19","12":"86","13":"58","14":"8.2","15":"62","16":"0.1","17":"613","18":"3.3e+05","19":"18","20":"18","21":"0.48","22":"10.0","23":"0","24":"0"},{"1":"Afghanistan","2":"2013","3":"Developing","4":"60","5":"268","6":"66","7":"0.01","8":"73.2","9":"64","10":"430","11":"18","12":"89","13":"62","14":"8.1","15":"64","16":"0.1","17":"632","18":"3.2e+07","19":"18","20":"18","21":"0.47","22":"9.9","23":"0","24":"0"},{"1":"Afghanistan","2":"2012","3":"Developing","4":"60","5":"272","6":"69","7":"0.01","8":"78.2","9":"67","10":"2787","11":"18","12":"93","13":"67","14":"8.5","15":"67","16":"0.1","17":"670","18":"3.7e+06","19":"18","20":"18","21":"0.46","22":"9.8","23":"0","24":"0"},{"1":"Afghanistan","2":"2011","3":"Developing","4":"59","5":"275","6":"71","7":"0.01","8":"7.1","9":"68","10":"3013","11":"17","12":"97","13":"68","14":"7.9","15":"68","16":"0.1","17":"64","18":"3.0e+06","19":"18","20":"18","21":"0.45","22":"9.5","23":"0","24":"0"},{"1":"Afghanistan","2":"2010","3":"Developing","4":"59","5":"279","6":"74","7":"0.01","8":"79.7","9":"66","10":"1989","11":"17","12":"102","13":"66","14":"9.2","15":"66","16":"0.1","17":"553","18":"2.9e+06","19":"18","20":"18","21":"0.45","22":"9.2","23":"0","24":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<hr />
</div>
<div id="using-formulae-in-r" class="section level1">
<h1>Using Formulae in R üë®‚Äçüè´</h1>
<p>R as coding language was specifically designed with statistical analysis in mind. Therefore the founding fathers of R üôå - in their infinite wisdom - decided to create a special object class (called <code>formula</code>) to help us run models.</p>
<div id="syntax" class="section level2">
<h2>Syntax</h2>
<p>A quick recap on the syntax that you can use within formulae. The <code>~</code> sign generally differentiates between dependent and independent variables. The <code>+</code> sign is used to distinguish between independent variables. Here are a few other lines that are nice to know:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="co"># standard formula</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> . <span class="co"># include all other columns in data as x vars</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x1 <span class="sc">*</span> x2 <span class="co"># Interaction terms</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="co"># higher order terms</span></span></code></pre></div>
<p>Formulae are very straightforward to work with. To avoid any errors you should follow the following two steps.</p>
<p><strong>Step 1:</strong> create a string containing the written formula. The <code>paste</code> function from last week is useful for this.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>formula_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;life_expectancy&quot;</span>, <span class="st">&quot;~ gdp&quot;</span>)</span></code></pre></div>
<p><strong>Step 2:</strong> transform the string into R class formula. Only then can you plug it into the model function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(formula_string) <span class="co"># needs to be transformed to correct class</span></span></code></pre></div>
<p>Here is the proof that both ways of doing it are identical.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">lm</span>(form, <span class="at">data =</span> life_expec_dat)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy <span class="sc">~</span> gdp, <span class="at">data =</span> life_expec_dat)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>form<span class="sc">$</span>coefficients <span class="sc">==</span> reg<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)         gdp 
##        TRUE        TRUE</code></pre>
</div>
<div id="for-iteration" class="section level2">
<h2>For Iteration</h2>
<p>We encourage you to <strong>fit many models</strong>, ranging from simple to complex, and formulae can help you in the iteration process.</p>
<p>Often, the modelling process requires you to run the same specification with <strong>multiple configurations</strong> of both <strong>dependent</strong> and <strong>independent</strong> variables. Model formulae make running many similar models super easy:</p>
<p><strong>Step 1</strong>: You define a function that let‚Äôs you plug in different variables at x or y. These functions take the y or x variable(s) as a string and return a model object.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to include different y variables.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>lm_fun_iter_y <span class="ot">&lt;-</span>  <span class="cf">function</span>(dep_var) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>( <span class="fu">as.formula</span>(<span class="fu">paste</span>(dep_var, <span class="st">&quot;~ gdp&quot;</span>)), <span class="at">data =</span> life_expec_dat)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># function to include different x variables. </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>lm_fun_iter_x <span class="ot">&lt;-</span> <span class="cf">function</span>(indep_var) {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>( <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">&quot;life_expectancy ~&quot;</span>, <span class="fu">paste</span>(indep_var, <span class="at">collapse =</span> <span class="st">&quot;+&quot;</span>))), <span class="at">data =</span> life_expec_dat)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## check what the function does</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#lm_fun_iter_x &lt;- function(indep_var) {</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  print(paste(&quot;life_expectancy ~&quot;, paste(indep_var, collapse = &quot;+&quot;)))</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<p><span style="color: red;">Notice:</span> It is unlikely you will run just a simple bivariate regression (i.e.¬†your model will include many independent variables). Therefore, we need to use a nested paste function that combines (<code>collapse()</code>) the input character vector with <code>+</code>.</p>
<p><strong>Step 2</strong>: You use <code>map()</code> (cf.¬†<a href="https://raw.githack.com/intro-to-data-science-21/labs/main/session-4-databases/4-databases.html">lab-session 4</a> to iterate the model over a vector or list of input variables:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of variables to iterate over</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> life_expec_dat <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;life_expectancy&quot;</span>, <span class="st">&quot;country&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># run a bivariate model for each column</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>biv_model_out <span class="ot">&lt;-</span>  vars <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(lm_fun_iter_x)</span></code></pre></div>
<p>This returns a list of all the models that your ran. Given that there are a quite a few models now, so it might be an idea to retain the names of the variables that you feed into your model. You can do this with <code>purrr::set_names()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run a bivariate model for each column</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>biv_model_out_w_names <span class="ot">&lt;-</span>  vars <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(lm_fun_iter_x)</span></code></pre></div>
<p>But say we are interested to see what effect gdp has on life_expectancy. Multiple potential combinations make sense. What if you want to run several different multivariate models? In addition to the code from the lectures you could use <code>modelR::formulas</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of combinations of vars</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>indep_vars_combos <span class="ot">&lt;-</span> modelr<span class="sc">::</span><span class="fu">formulas</span>(<span class="sc">~</span>life_expectancy,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Bivariate OLS&quot;</span>  <span class="ot">=</span> <span class="er">~</span> gdp,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Multivariate OLS&quot;</span> <span class="ot">=</span> <span class="er">~</span> gdp <span class="sc">+</span> total_expenditure <span class="sc">+</span> population <span class="sc">+</span> alcohol <span class="sc">+</span> bmi ,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Interaction&quot;</span> <span class="ot">=</span> <span class="er">~</span> population <span class="sc">+</span> gdp <span class="sc">*</span> total_expenditure,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Polynomial&quot;</span> <span class="ot">=</span> <span class="er">~</span> gdp <span class="sc">+</span> <span class="fu">I</span>(gdp<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>multiv_model_out <span class="ot">&lt;-</span> indep_vars_combos <span class="sc">%&gt;%</span>  <span class="fu">map</span>(lm, <span class="at">data =</span> life_expec_dat)</span></code></pre></div>
<p>As you can see the function in the lecture is a lot more powerful, but in my admittedly very modest experience, the preceding code resembles the actual scientific workflow more closely.</p>
<hr />
</div>
</div>
<div id="specification-curve-analysis" class="section level1">
<h1>Specification Curve Analysis</h1>
<p>In the above example, I made a conscious choice to run these four specific models. This conscious choice should reflect insights from theory (here: not so much) and be defensible (eh‚Ä¶). Unfortunately, some researchers argue that by making a conscious choice, I select an arbitrary or possibly even biased model specification. They propose to approach model specification analytically.</p>
<p>They call this Specification Curve Analysis, or Multiverse Analysis. There is a very nice package to run this: <code>specr</code>. In very simplistic terms it follows this path:</p>
<p><strong>First</strong> you compile a list of defensible ‚Äúmodel ingredients‚Äù:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setup_specs</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;life_expectancy&quot;</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We add an additional dependent variable</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;gdp&quot;</span>, <span class="st">&quot;log(gdp)&quot;</span>, <span class="st">&quot;I(gdp^2)&quot;</span>, <span class="st">&quot;gdp * total_expenditure&quot;</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are not sure which independent variable is better</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;lm&quot;</span>, <span class="st">&quot;glm&quot;</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We only use linear model or more complicated one</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">controls =</span> <span class="fu">c</span>(<span class="st">&quot;population&quot;</span>, <span class="st">&quot;alcohol&quot;</span>, <span class="st">&quot;bmi&quot;</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["chr"],"align":["left"]},{"label":["y"],"name":[2],"type":["chr"],"align":["left"]},{"label":["model"],"name":[3],"type":["chr"],"align":["left"]},{"label":["controls"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"gdp","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi"},{"1":"I(gdp^2)","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi"},{"1":"gdp","2":"life_expectancy","3":"lm","4":"population"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"population"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"population"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"lm","4":"population"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"population"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"population"},{"1":"I(gdp^2)","2":"life_expectancy","3":"glm","4":"population"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"glm","4":"population"},{"1":"gdp","2":"life_expectancy","3":"lm","4":"alcohol"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"alcohol"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"alcohol"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"lm","4":"alcohol"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"alcohol"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"alcohol"},{"1":"I(gdp^2)","2":"life_expectancy","3":"glm","4":"alcohol"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"glm","4":"alcohol"},{"1":"gdp","2":"life_expectancy","3":"lm","4":"bmi"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"bmi"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"bmi"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"lm","4":"bmi"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"bmi"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"bmi"},{"1":"I(gdp^2)","2":"life_expectancy","3":"glm","4":"bmi"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"glm","4":"bmi"},{"1":"gdp","2":"life_expectancy","3":"lm","4":"no covariates"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"no covariates"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"no covariates"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"lm","4":"no covariates"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"no covariates"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"no covariates"},{"1":"I(gdp^2)","2":"life_expectancy","3":"glm","4":"no covariates"},{"1":"gdp * total_expenditure","2":"life_expectancy","3":"glm","4":"no covariates"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>Second</strong> you define additional analytical choices such as: model family, potential subgroups to run it over etc.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run specification curve analysis (under the hood it uses setup_specs())</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_specs</span>(<span class="at">df =</span> life_expec_dat, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;life_expectancy&quot;</span>),               <span class="co"># We add an additional dependent variable</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;gdp&quot;</span>, <span class="st">&quot;log(gdp)&quot;</span>, <span class="st">&quot;I(gdp^2)&quot;</span>, <span class="st">&quot;gdp:total_expenditure&quot;</span>),         <span class="co"># We are not sure which independent variable is better</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;lm&quot;</span>, <span class="st">&quot;glm&quot;</span>),           <span class="co"># We only use linear model or more complicated one</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">controls =</span> <span class="fu">c</span>(<span class="st">&quot;population&quot;</span>, <span class="st">&quot;alcohol&quot;</span>, <span class="st">&quot;bmi&quot;</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">subsets =</span> <span class="fu">list</span>(<span class="at">developed =</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(life_expec_dat<span class="sc">$</span>developed))) <span class="co"># so it is 1 or 0, not sure why author of pkg choose to do it this way</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["chr"],"align":["left"]},{"label":["y"],"name":[2],"type":["chr"],"align":["left"]},{"label":["model"],"name":[3],"type":["chr"],"align":["left"]},{"label":["controls"],"name":[4],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["obs"],"name":[11],"type":["int"],"align":["right"]},{"label":["subsets"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"gdp","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi","5":"3.8e-04","6":"3.1e-05","7":"12.2","8":"5.9e-33","9":"3.2e-04","10":"4.4e-04","11":"1711","12":"developed = 0"},{"1":"log(gdp)","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi","5":"1.7e+00","6":"1.2e-01","7":"14.2","8":"2.7e-43","9":"1.5e+00","10":"1.9e+00","11":"1711","12":"developed = 0"},{"1":"I(gdp^2)","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi","5":"6.6e-09","6":"8.1e-10","7":"8.2","8":"6.1e-16","9":"5.0e-09","10":"8.2e-09","11":"1711","12":"developed = 0"},{"1":"gdp:total_expenditure","2":"life_expectancy","3":"lm","4":"population + alcohol + bmi","5":"4.2e-05","6":"3.9e-06","7":"10.9","8":"9.5e-27","9":"3.5e-05","10":"5.0e-05","11":"1711","12":"developed = 0"},{"1":"gdp","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi","5":"3.8e-04","6":"3.1e-05","7":"12.2","8":"5.9e-33","9":"3.2e-04","10":"4.4e-04","11":"1711","12":"developed = 0"},{"1":"log(gdp)","2":"life_expectancy","3":"glm","4":"population + alcohol + bmi","5":"1.7e+00","6":"1.2e-01","7":"14.2","8":"2.7e-43","9":"1.5e+00","10":"1.9e+00","11":"1711","12":"developed = 0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>Third</strong> You inspect the specification curve to understand how robust your findings are to different analytical choices.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_decisiontree</span>(results, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="6-modelling_files/figure-html/unnamed-chunk-13-1.png" width="672" /> This decision tree helps illustrate where and when you had to make a choice and how many models you might alternatively have specified.</p>
<p>More concretely you could also look at some summary statistics for your p-values across the different model specifications:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise_specs</span>(results, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">var =</span> <span class="fu">c</span>(<span class="st">&quot;std.error&quot;</span>, <span class="st">&quot;estimate&quot;</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["std.error_median"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["estimate_median"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error_mad"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["estimate_mad"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["std.error_min"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["estimate_min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["std.error_max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["estimate_max"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["std.error_q25"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["estimate_q25"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["std.error_q75"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["estimate_q75"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["obs"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.8e-06","2":"6.2e-05","3":"8.7e-06","4":"9.2e-05","5":"9.4e-11","6":"6.4e-10","7":"0.12","8":"3.1","9":"6.4e-07","10":"4.7e-06","11":"0.021","12":"0.19","13":"1904","_row":"25%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The statistic <span style="color: red;">mad</span> stands for <span style="color: red;">median absolute deviation</span>.</p>
<p>A more intuitive way of inspecting the results might lie in visualising them.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_specs</span>(results)</span></code></pre></div>
<p><img src="6-modelling_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p><strong>Plot A</strong> denotes: * X-axis = ordered model specifications (from most negative effect to most positive effect) * Y-axis = standardized regression coefficient for the IV-DV relationship * Points = the standardized regression coefficient for a specific models * Error bars = 95% confidence intervals around the point estimate</p>
<p><strong>Plot B</strong> denotes: * X-axis = ordered model specifications (the same as panel A) * Y-axis (right) = analytic decision categories * Y-axis (left) = specific analytic decisions within each category * Lines = denote that a specific analytic decision was true for that model specification</p>
<p>Without putting much thought into our model it looks like gdp (depending on the specification) has either no effect or positive effects on life_expectancy. This just goes to show how <em>careful</em> one has to approach the task of <em>correctly specifying a model</em>!</p>
<div class="noticebox">
<div class="center">
<p><strong>Watch Out!</strong></p>
</div>
<p>Be careful and <strong>selective</strong> when you use specification curve analysis! It is not a tool that you should apply to each and every potential paper. Especially, if you have not taken a course on <strong>causal inference</strong>. Specification curve analysis, when it includes variables that act as <strong>colliders</strong> or <strong>mediators</strong> might actually legitimise an otherwise wrongly specified model!</p>
</div>
<hr />
</div>
<div id="model-output-with-broom" class="section level1">
<h1>Model Output with <code>broom</code></h1>
<p>In the lecture we saw, that vanilla model lists can be unwieldy. Simon also pointed out that we are interested in three main aspects of out model outputs:</p>
<ul>
<li><strong>Estimated coefficients</strong> and associated standard errors, T-statistics, p-values, confidence intervals</li>
<li><strong>Model summaries</strong>, including goodness of fit measures, information on model convergence, number of observations used</li>
<li><strong>Observation-level</strong> information that arises from the estimated model, such as fitted/predicted values, residuals, estimates of influence</li>
</ul>
<p>Extracting this information from the vanilla model output is possible, but hardly ideal:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(multiv_model_out[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## List of 13
##  $ coefficients : Named num [1:5] 6.19e+01 6.42e-10 4.66e-04 7.57e-01 -2.06e-05
##   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;(Intercept)&quot; &quot;population&quot; &quot;gdp&quot; &quot;total_expenditure&quot; ...
##  $ residuals    : Named num [1:2120] -3.3 -8.4 -8.39 -9.07 -8.71 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:2120] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ effects      : Named num [1:2120] -3158.9 -10.1 212.1 -58.4 -39.1 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:2120] &quot;(Intercept)&quot; &quot;population&quot; &quot;gdp&quot; &quot;total_expenditure&quot; ...
##  $ rank         : int 5
##  $ fitted.values: Named num [1:2120] 68.3 68.3 68.3 68.6 67.9 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:2120] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
....</code></pre>
<div id="tidying-model-objects" class="section level2">
<h2>Tidying Model Objects</h2>
<p>Luckily we don‚Äôt have to deal with this. We use a package called <code>broom</code> that is part of the <a href="https://www.tidyverse.org/">tidyverse</a> and more precisely <a href="https://www.tidymodels.org/">tidymodels</a>. The latter offers a lot of cool packages that have their own tutorials, so check them out! üí™.</p>
<p>We will only focus on broom. As a reminder, here are the three key broom functions that you need to learn:</p>
<ol style="list-style-type: decimal">
<li><code>tidy()</code>: Summarizes information about model components.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(multiv_model_out[[<span class="dv">3</span>]], <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"6.2e+01","3":"5.9e-01","4":"105.59","5":"0.0e+00","6":"6.1e+01","7":"6.3e+01"},{"1":"population","2":"6.4e-10","3":"3.0e-09","4":"0.22","5":"8.3e-01","6":"-5.2e-09","7":"6.5e-09"},{"1":"gdp","2":"4.7e-04","3":"3.6e-05","4":"12.77","5":"5.0e-36","6":"3.9e-04","7":"5.4e-04"},{"1":"total_expenditure","2":"7.6e-01","3":"9.3e-02","4":"8.14","5":"6.8e-16","6":"5.7e-01","7":"9.4e-01"},{"1":"gdp:total_expenditure","2":"-2.1e-05","3":"4.5e-06","4":"-4.54","5":"6.0e-06","6":"-3.0e-05","7":"-1.2e-05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ol start="2" style="list-style-type: decimal">
<li><code>glance()</code>: Reports information about the entire model.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(multiv_model_out[[<span class="dv">3</span>]])</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.24","2":"0.24","3":"8.6","4":"169","5":"1.3e-125","6":"4","7":"-7569","8":"15149","9":"15183","10":"156607","11":"2115","12":"2120","_row":"value"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ol start="3" style="list-style-type: decimal">
<li><code>augment()</code>: Adds information about observations to a dataset.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(multiv_model_out[[<span class="dv">3</span>]], <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[".rownames"],"name":[1],"type":["chr"],"align":["left"]},{"label":["life_expectancy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["population"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["gdp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["total_expenditure"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".se.fit"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[9],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[10],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"65","3":"3.4e+07","4":"584","5":"8.2","6":"68","7":"0.31","8":"-3.3","9":"0.0013","10":"8.6","11":"3.7e-05","12":"-0.38"},{"1":"2","2":"60","3":"3.3e+05","4":"613","5":"8.2","6":"68","7":"0.30","8":"-8.4","9":"0.0012","10":"8.6","11":"2.3e-04","12":"-0.98"},{"1":"3","2":"60","3":"3.2e+07","4":"632","5":"8.1","6":"68","7":"0.30","8":"-8.4","9":"0.0012","10":"8.6","11":"2.3e-04","12":"-0.98"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>I mean, doesn‚Äôt this look a lot more accessible?</p>
</div>
<div id="broom-with-many-models" class="section level2">
<h2>Broom with Many Models</h2>
<p>Where <code>broom</code> really shines, is in dealing with many models like we have in our <code>multiv_model_out</code>. It allows us to easily move away from the generally painful-to-deal-with lists and create yet retain each of the three important model returns. Since our example replicates several variables in different models, I include the .id argument in map. It adds a column to our tibble with an <strong>model identifier</strong>. In our case this identifier consists of the names of the elements in the list.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>multiv_model_out_broom <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(multiv_model_out, broom<span class="sc">::</span>tidy, <span class="at">.id =</span> <span class="st">&quot;model_type&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>multiv_model_out_broom <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["term"],"name":[2],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Bivariate OLS","2":"(Intercept)","3":"6.7e+01","4":"1.9e-01","5":"345.7","6":"0.0e+00"},{"1":"Bivariate OLS","2":"gdp","3":"3.1e-04","4":"1.2e-05","5":"25.9","6":"2.7e-131"},{"1":"Multivariate OLS","2":"(Intercept)","3":"5.7e+01","4":"5.0e-01","5":"114.3","6":"0.0e+00"},{"1":"Multivariate OLS","2":"gdp","3":"1.9e-04","4":"1.3e-05","5":"14.4","6":"1.2e-44"},{"1":"Multivariate OLS","2":"total_expenditure","3":"1.2e-01","4":"7.1e-02","5":"1.7","6":"9.8e-02"},{"1":"Multivariate OLS","2":"population","3":"4.3e-09","4":"2.5e-09","5":"1.7","6":"9.2e-02"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Now that we have our multiple model outputs in a format that we can work with normally, it is time to start thinking about visualizing our results. You can plot the residuals, the goodness of fit statistics etc. Similarly you could also use the <code>glance()</code> to provide some robustness statistics or descriptive tables.</p>
<p>What we will be focusing on in the next section is how to <strong>present your results</strong>!</p>
<hr />
</div>
</div>
<div id="modelling-results-with-modelsummary" class="section level1">
<h1>Modelling Results with <code>modelsummary</code></h1>
<p>For this we will use the excellent <code>modelsummary</code> package by <a href="https://vincentarelbundock.github.io/modelsummary/">Vincent Arel-Bundock‚Äôs</a>. Though there are many other options to choose from, we highly recommend you give it a shot!</p>
<p>One reason that we like this package, is that it combines both ways of presenting model results, in a <strong>table</strong> or in a <strong>coefficient plot</strong>. As we saw in the lecture each method has its advantages and its drawbacks. Therefore, we will cover both here.</p>
<div id="using-regression-tables" class="section level2">
<h2>Using Regression Tables</h2>
<p>The workhorse function in <code>modelsummary</code> is unsurprisingly <code>modelsummary()</code>. ü§î</p>
<p>Here we only need to input the <span style="color: red;">models list</span> as, the function already takes care of the tidying for us.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(multiv_model_out, <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Bivariate OLS
</th>
<th style="text-align:center;">
Multivariate OLS
</th>
<th style="text-align:center;">
Interaction
</th>
<th style="text-align:center;">
Polynomial
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
67.035
</td>
<td style="text-align:center;">
56.622
</td>
<td style="text-align:center;">
61.927
</td>
<td style="text-align:center;">
65.878
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.194)
</td>
<td style="text-align:center;">
(0.496)
</td>
<td style="text-align:center;">
(0.586)
</td>
<td style="text-align:center;">
(0.202)
</td>
</tr>
<tr>
<td style="text-align:left;">
gdp
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
(0.000)
</td>
</tr>
<tr>
<td style="text-align:left;">
total_expenditure
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.118
</td>
<td style="text-align:center;">
0.757
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.071)
</td>
<td style="text-align:center;">
(0.093)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
population
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
alcohol
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.047)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
bmi
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.232
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.009)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
gdp √ó total_expenditure
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(0.000)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
I(gdp^2)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.000)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
2485
</td>
<td style="text-align:center;">
2101
</td>
<td style="text-align:center;">
2120
</td>
<td style="text-align:center;">
2485
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.213
</td>
<td style="text-align:center;">
0.457
</td>
<td style="text-align:center;">
0.242
</td>
<td style="text-align:center;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.213
</td>
<td style="text-align:center;">
0.456
</td>
<td style="text-align:center;">
0.241
</td>
<td style="text-align:center;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
17726.8
</td>
<td style="text-align:center;">
14320.3
</td>
<td style="text-align:center;">
15149.2
</td>
<td style="text-align:center;">
17519.7
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
17744.2
</td>
<td style="text-align:center;">
14359.8
</td>
<td style="text-align:center;">
15183.2
</td>
<td style="text-align:center;">
17542.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
‚àí8860.382
</td>
<td style="text-align:center;">
‚àí7153.136
</td>
<td style="text-align:center;">
‚àí7568.612
</td>
<td style="text-align:center;">
‚àí8755.827
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
671.782
</td>
<td style="text-align:center;">
352.824
</td>
<td style="text-align:center;">
168.870
</td>
<td style="text-align:center;">
474.181
</td>
</tr>
</tbody>
</table>
<p>It looks pretty solid already, but unfortunately it is not yet good enough.</p>
<p><strong>Set acceptable number of digits</strong>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(multiv_model_out, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="st">&quot;%.2f&quot;</span>) <span class="co"># 2-digits and trailing 0</span></span></code></pre></div>
<p>And let us also report <strong>only the C.I.</strong> and get rid of the p-values and the Intercept term:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model_table <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(multiv_model_out, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="st">&quot;%.2f&quot;</span>,  <span class="co"># 2-digits and trailing 0  </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">&quot;{estimate}&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="st">&quot;conf.int&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">&quot;Intercept&quot;</span>) </span></code></pre></div>
<p>Would it not also look more professional if we had our <strong>coefficients begin with capital letter</strong>? And how about we get rid of some of the bloated goodness of fit statistics?</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mod_table <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(multiv_model_out, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">output =</span> <span class="st">&quot;default&quot;</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="st">&quot;%.2f&quot;</span>,  <span class="co"># 2-digits and trailing 0  </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">&quot;{estimate}&quot;</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="st">&quot;conf.int&quot;</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">&quot;Intercept&quot;</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_rename=</span><span class="fu">c</span>(<span class="st">&quot;gdp&quot;</span><span class="ot">=</span><span class="st">&quot;Gdp&quot;</span>, <span class="st">&quot;bmi&quot;</span><span class="ot">=</span><span class="st">&quot;Avg. BMI&quot;</span>, <span class="st">&quot;alcohol&quot;</span> <span class="ot">=</span> <span class="st">&quot;Alcohol Consum.&quot;</span>,<span class="st">&quot;population&quot;</span><span class="ot">=</span> <span class="st">&quot;Pop.&quot;</span>, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;gdp:total_expenditure&quot;</span> <span class="ot">=</span> <span class="st">&quot;Gdp * Health Expenditure (total)&quot;</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;total_expenditure&quot;</span><span class="ot">=</span><span class="st">&quot;Health Expenditure (total)&quot;</span>, <span class="st">&quot;I(gdp^2)&quot;</span> <span class="ot">=</span><span class="st">&quot;Gdp¬≤&quot;</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">&#39;DF|Deviance|Log.Lik|AIC|BIC&#39;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">&#39;A Most Beautiful Regression Table&#39;</span>)</span></code></pre></div>
<p>When using the <code>kableExtra</code> package you can even post-process your table:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mod_table <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="at">full_width =</span> F, <span class="at">fixed_thead =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">5</span>, <span class="at">background =</span> <span class="st">&#39;lightblue&#39;</span>)</span></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
A Most Beautiful Regression Table
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Bivariate OLS
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Multivariate OLS
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Interaction
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Polynomial
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Gdp
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
[0.00, 0.00]
</td>
<td style="text-align:center;">
[0.00, 0.00]
</td>
<td style="text-align:center;">
[0.00, 0.00]
</td>
<td style="text-align:center;">
[0.00, 0.00]
</td>
</tr>
<tr>
<td style="text-align:left;color: red !important;">
Health Expenditure (total)
</td>
<td style="text-align:center;color: red !important;">
</td>
<td style="text-align:center;color: red !important;">
0.12
</td>
<td style="text-align:center;color: red !important;">
0.76
</td>
<td style="text-align:center;color: red !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
[‚àí0.02, 0.26]
</td>
<td style="text-align:center;">
[0.57, 0.94]
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: lightblue !important;">
Pop.
</td>
<td style="text-align:center;background-color: lightblue !important;">
</td>
<td style="text-align:center;background-color: lightblue !important;">
0.00
</td>
<td style="text-align:center;background-color: lightblue !important;">
0.00
</td>
<td style="text-align:center;background-color: lightblue !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
[‚àí0.00, 0.00]
</td>
<td style="text-align:center;">
[‚àí0.00, 0.00]
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Alcohol Consum.
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.29
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
[0.20, 0.38]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Avg. BMI
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.23
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
[0.21, 0.25]
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Gdp * Health Expenditure (total)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
‚àí0.00
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
[‚àí0.00, ‚àí0.00]
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Gdp¬≤
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
‚àí0.00
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[‚àí0.00, ‚àí0.00]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
2485
</td>
<td style="text-align:center;">
2101
</td>
<td style="text-align:center;">
2120
</td>
<td style="text-align:center;">
2485
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.213
</td>
<td style="text-align:center;">
0.457
</td>
<td style="text-align:center;">
0.242
</td>
<td style="text-align:center;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.213
</td>
<td style="text-align:center;">
0.456
</td>
<td style="text-align:center;">
0.241
</td>
<td style="text-align:center;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
671.782
</td>
<td style="text-align:center;">
352.824
</td>
<td style="text-align:center;">
168.870
</td>
<td style="text-align:center;">
474.181
</td>
</tr>
</tbody>
</table>
</div>
<div id="using-plots" class="section level2">
<h2>Using Plots</h2>
<p>If you are after an alternative way to present your results, you might also consider a nice <strong>coefficient plot</strong> üé®</p>
<p>Again <code>modelsummary</code> provides a very accessible function to do so: <code>modelplot()</code>. As with the regression table you input the <span style="color: red;">Model List</span> and not the tidied output. This already happens under the hood.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelplot</span>(multiv_model_out[[<span class="dv">2</span>]], <span class="at">coef_omit =</span> <span class="st">&#39;Interc&#39;</span> )</span></code></pre></div>
<p><img src="6-modelling_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The default output is already pretty good, but how can we improve on it? More importantly can we create a coefficient plot that displays all our models?</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelplot</span>(multiv_model_out, <span class="at">coef_omit =</span> <span class="st">&#39;Interc&#39;</span>)</span></code></pre></div>
<p><img src="6-modelling_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now we only need to customise the plot to our liking:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The palette with grey:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>, <span class="st">&quot;#009E73&quot;</span>, <span class="st">&quot;#F0E442&quot;</span>, <span class="st">&quot;#0072B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#CC79A7&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or you might use any other Paletter inherent to R</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">modelplot</span>(multiv_model_out, <span class="at">coef_omit =</span> <span class="st">&quot;Intercept&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Coefficients&#39;</span>, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;Term names&#39;</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&#39;Linear regression models of &quot;Life expectancy&quot;&#39;</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;Comparing multiple models, the data originated at the WHO&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cbPalette)</span></code></pre></div>
<p><img src="6-modelling_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We will cover the visualisation aspect in R in much greater detail in the coming session, so hopefuly the section on <strong>coefficient plot</strong> will become clearer then!</p>
<hr />
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
<p>If you want to practice the above you can find more materials <a href="https://github.com/intro-to-data-science-21/labs/blob/main/practice-scripts/07-model-fitting.R">here</a>.</p>
<p>Rather than do individual exercises this week we wanted to discuss different recording options for the upcoming Workshop Presentation.</p>
<hr />
</div>
<div id="appendix-1-tools-to-prepare-the-workshop" class="section level1 tabset tabset-fade tabset-pills">
<h1 class="tabset tabset-fade tabset-pills">Appendix 1: Tools to Prepare the Workshop üìΩ</h1>
<p>Soon the Workshop will be upon us. To help you prepare the recording of your presentation we wanted to present you with two options that</p>
<div id="using-zoom" class="section level2">
<h2>Using Zoom</h2>
<p>For this to work you need to register for a free Zoom Account <a href="https://zoom.us/pricing?zcid=3216&amp;gclid=CjwKCAjw_L6LBhBbEiwA4c46ugXZZvhl6EGXJXvQVROW1m45QMBRwxsIPMQRDHMe6zcNhGoEcKL-WhoC11cQAvD_BwE">here</a>. In order to record yourself follow these steps:</p>
<p><strong>Step 1</strong> Host a meeting by yourself and have the video turned on (it should be focused on you):</p>
<p><img src="pics/Screenshot%202021-10-15%20at%2012.05.25.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Step 2</strong> Connect to audio and share screen (I usually chose Desktop 1, so I‚Äôm flexible to switch between applications - make sure to keep your desktop clean)</p>
<p><img src="pics/Screenshot%202021-10-15%20at%2012.06.47.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Step 3</strong> Open the window/application that you will use for your presentation, place the little window with your face in one of the corners (so it does not hover somewhere distracting) and start recording.</p>
<p><img src="pics/Screenshot%202021-10-15%20at%2012.07.41.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now you have complete freedom to work with your laptop as usual (including doing a power point slide show), everything is recorded (except the zoom internal menu / dropdown options).</p>
<p>You can pause, continue (if necessary) and finally, stop the recording. The recording is saved and converted to mp4 after the end of the call.</p>
<p><img src="pics/Screenshot%202021-10-15%20at%2012.09.30.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Should you feel the need to edit the video (for example, trim the length), the easiest option is to just use the tool inside the Quicktime player. This way you can edit the start and end of the video.</p>
<hr />
</div>
<div id="using-powerpoint" class="section level2">
<h2>Using PowerPoint</h2>
<p>For this to work you need to have an official MS Powerpoint licence and a finished presentation. In order to record yourself and the presentation follow these steps:</p>
<p><strong>Step 1</strong> Open a Presentation and click on Record Slide Show &gt; Record from Current Slide (if you are at the start of the ppt.)</p>
<p><img src="pics/ppt_record_1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Step 2</strong> Use the three buttons in the Upper Left to Corner to navigate the recording.</p>
<p><img src="pics/ppt_record_2.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Step 3</strong> Additional features include the option to use Slide Notes ‚Ä¶</p>
<p><img src="pics/ppt_record_3.png" width="70%" style="display: block; margin: auto;" /></p>
<p>‚Ä¶ and the colours and pens at the bottom to draw and highlight elements of a slide.</p>
<p><img src="pics/ppt_record_5.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Step 4</strong> Saving your recording as a video file</p>
<p>When you‚Äôre done recording, save your file and recording.</p>
<p>Then click on File &gt; Export &gt; Create a Video.</p>
<p>Powerpoint will now present you with a number of options regarding the quality of the video (go for the highest possible resolution) and whether you would like your video to include narration and slide timings. For most of you this should not apply.</p>
<p>Then choose a destination to save the video and you are all set.</p>
<hr />
</div>
<div id="alternative-options-to-record-presentations" class="section level2">
<h2>Alternative Options to record presentations</h2>
<p>The Readme on the <a href="https://github.com/intro-to-data-science-21/workshop-presentations">Workshop Github</a> contains a number of online video tutorials for a number of different Tools that you can have a look at. Similarly it offers more potent software tutorials on cutting and editing your videos.</p>
</div>
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<p>This tutorial drew heavily on the vignette from the <a href="https://cran.r-project.org/web/packages/specr/vignettes/specr.html"><em>specr package</em></a> as well as the <a href="https://raw.githack.com/uo-ec607/lectures/master/08-regression/08-regression.html#Presentation"><em>Regression Section</em></a> in McDermott‚Äôs Data Science for Economists by Grant McDermott.</p>
</div>

&nbsp;
<hr />
<p style="text-align: center;">A work by Lisa Oswald & Tom Arend</a></p>
<p style="text-align: center;"><span style="color: #808080;"><em>Prepared for Intro to Data Science, taught by Simon Munzert</em></span></p>
<p style="text-align: center;"><span style="color: #808080;"><em><a href="https://www.hertie-school.org/en/">Hertie School, Berlin</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" >

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/intro-to-data-science-21"  <i class="fab fa-github"></i><a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
